##LIBRARIES
import time
import schedule
import pyautogui as pyg
import os
import PyPDF2
from PyPDF2 import PdfFileReader, PdfFileWriter
import re

##INPUTS
inputs = input('Input all X:', ) #put the input with spaces

path_to_pdf_file = input('Input PDF path:', )

inputs_split_into_list = [item for item in inputs.split()]

adobe_input = path_to_pdf_file

list_of_items = inputs_split_into_list
listnum = []

##MAIN FUNCTION
#Pdf Object
object = PyPDF2.PdfFileReader(adobe_input)

#Get number of pages
NumPages = object.getNumPages()
def find_pg():
    for vin in listvin:
        # Extract text and do the search
        for i in range(0, NumPages):
            PageObj = object.getPage(i)
            Text = PageObj.extractText()
            if re.search(vin,Text):
                listnum.append(i)
                listnum.append(i+1)
        zaz = (len(listnum)/2)/len(listvin)*100
        print(round(zaz,2),end="\r")
find_pg()

##CONCATING ALL OF THE FILES
adobe_input = adobe_input[:-4]

pdf_file_path = adobe_input + '.pdf'
file_base_name = pdf_file_path.replace('.pdf', '')

pdf = PdfFileReader(pdf_file_path)

pages = listnum # page 1, 3, 5
pdfWriter = PdfFileWriter()

for page_num in pages:
    pdfWriter.addPage(pdf.getPage(page_num))

with open('{0}_subset.pdf'.format(file_base_name), 'wb') as f:
    pdfWriter.write(f)
    f.close()

##SENDING THE NEW FILE TO THE PRINTER 
os.startfile(adobe_input + "_subset" + ".pdf" , 'print')
